# 第15课-批量操作

大家好，现在我们来学习第十五课批量操作。这节课的内容包括有制作表格目录制作文件目录批量修改表格名称，批量修改文件名称，批量插入图片和批量新建文件夹六个部分。

本次课程会涉及sr 命令提示符和批处理等三个方面的知识，能实现工作中的批量操作。虽然使用的场景并不多，但非常实用，能够大大提高你的工作效率。

本次课程的操作源文件大家可以在微信公众号搜索维库后台回复零五零六进行获取。首先我们进入第。第一部分制作表格目录的学习。看到现在的这个表格里面呢，一共包含了六个工作表，一个表格目录，三个月份的销售流水表，一个数据汇总表和一个统计表。

工作表数量不多的时候，我们可以通过点击下面的这些表名称进行切换。但一旦工作表数量很多的时候，就需要花费大量的时间来找表格了。

在这样的情况下呢，我们可以在起始的位置制作一份表格目录，方便我们寻找和切换工作表。制作表格目录的方法很简单，主要分为两个步骤，第一步呢是需要打开公式选项卡，使用到这个名称管理器的。

那首先呢我把第一个。自定义名称的公式复制一下，然后选中ae 单元格，然后打开名称管理器。这里点击新建名称，这里呢我输入目录，然后引用位置。这里呢我把刚刚复制的一个。

是复制粘贴到a 一单元格。好，然后呢往下复制填充公式，得到各个表的连接。我们也来看一下这个公式还不能函数呢有两个参数。第一个参数呢是链接的位置。

好，我们具体到ae 这里来看一下使用f 九呢查看分布计算的结果。这里了，我把你打入这一段，一直到ae 这里查看一下，这里返回的链接位置呢是表格目录这个工作表的a 一单元格。

第二个呢参数呢显示的呢是名称，这里呢是显示。的，这里搞错了，应该是到这个位置显示的呢。就是现在我们刚刚在a 一单元格里面看到的表格目录，n b 等函数呢里面引用的呢就是刚刚在名称管理器里面新建的名称目录了。

因为呢在a 一单元格这里了，所在的行是一，所以在名称你的微函数呢对应的就是第一张工作表。那往下a 二a 三一四对应的呢就是第二张第三张工作表了，以此类推。

这里要注意的是，为了让这个公式的逻辑更加严密呢，防止工作表前面存在空格怡导致无法正常提取工作表名称。所以我们在第一个参数前面呢加上了一个几号啊。

代表任意字符。然后呢再和后面的公式呢连接起来。现在呢我们就可以点击对应的单元格，好跳转到不同的工作表里面去了。那我们跳转到各个工作表以后呢，要重新回到表格目录这里呢也要点击下面对应的这一个表和目录的名称，这样感觉也挺麻烦的，但没有关系。

我们可以在每个工作表里面呢加一个返回目录首页的跳转链接。好，我把这一个公式呢复制一下。然后呢在医院流水表里面的这个位置啊，把它粘贴进来，然后呢点击一下诶，可以返回到第一个表格目录这个工作表这里。

好，然后呢把这一个。单元格呢复制粘贴到这个工作表里面。好了。那我们现在呢就可以通过点击这一个返回目录的单元格连接。

好在各个工作表的时候呢，我们可以快速的返回到表格目录。这个工作表ae 的单元格上了。那这是第一部分的内容制作表格目录的操作方法。看到这个文件夹里面有很多不同类型的文件。

那当一个文件夹里面呢有很多文件的时候，要找到具体的某一个文件的话费的功夫也是比较大的。我们也可以用excel 表格制作一个文件目录，方便我们去浏览和查找对应的文件。

具体怎么操作呢？可以分为两个步骤。第一个步骤我们使用命令。命题是否c md 来创建一个srf 表格，按键盘的windows 键加上二键打开运行对话框。然后在这里呢输入c n d 好按回车，然后呢在这里输入具体的命令。

首先输入了dir 然后是空格，然后是文件所在的位置。这里呢我把文件夹的位置复制粘贴到这里来。好，然后呢这里在加一个空格，输入左斜杠然后呢b 然后是大于号，然后空格然后呢是生成这个表格所在的位置。

这里呢在同一个文件夹项链生成无法位置在粘贴一次。好，然后呢是对应的。一个文件名称。这里首先加上一个右斜杠，然后呢我们剑灵中我们就把它叫做文件目录。

然后呢后缀名sls 好按回车确定。然后呢我们关闭这个对话框，在这个文件夹里面呢，我们看到有一个新建的名为文件目录的excel 表格。

然后呢打开它好不匹配啊，人家要打开看到这个工作表呢，就把文件夹里面的所有文件做成了一个目录的形式。那我把呢文件目录这一个商标，然后呢在第一行这里我加上一个标题特点，就叫做文件名称。

好。在这个基础上呢，我希望能够在b 列做一个链接。通过点击他呢能够直接打开对应的文件。这里呢还是应用到还不能函数来做跳转。

然后呢在这个b 二这里呢，我输入公式have a link，然后呢这里呢对应的一个位置呢，就是我们刚刚的这一个位置啊，这里呢规范上面呢把c 盘的盘符给删掉。

然后呢这里是一个啊首先还不令呢。第一个呢就是制作文件目录下。然后呢对应的是a 二这个名称的文件。然后呢这个参数这里呢就显示唯。

打开对应文件，然后回车确定。然后呢我这里呢就把这个公式复制填充到下面这一栏。然后呢我们具体点一下每一个名称啊，这里呢去打开了三月流水的这样一张表格。然后比如说我要打开第一季度总结，这里呢也能够打开对应的文件呢。

好，这里呢为了保证我们这个还悖论函数能够正常运行呢。这里我把工作部重新另存为一个呃新版的这样的一个工作簿。

好，那以后呢就可以使用这个excel 文件作为文件夹目录了。好，这里呢我们再重新看一下这一个还不能函数的第一个参数。

这里他就是打开对应位置下啊这个文件。比如说这里就是a 九这个单元格对应的一个文件名称啊，通过这样的写法来打开对应的文件。

好，这里要注意的是呢在使用命令提示符c md 的时候，文件夹了，不能使用过多的中文来做命名。同时呢也不能使用特殊符号来命名文件夹，而且文件夹最好了。

不要在多个根目录下，不然呢会导致命令提示符无法正常的创建文件目录。那这是第二部分的内容制作文件目录的操作方法。

接下来我们学习第三部分的内容，批量修改表格名称。看到现在的这个案例，这里呢一共有六个工作表，分别是幺七年的一院，一直到幺七年的六月的流水。

但现在呢我发现工作表的命名是错误的，应该呢统一把幺七年修改为二零幺八零才对。对于这种批量修改工作表名称的场景，我们可以使用下面的方法。

首先呢我把这个表格给关闭掉。然后呢在对应的文件夹下面我找到。对应的一个文件，单击鼠标的右键，这里呢选择重命名，然后呢把后缀名啊修改为哎呀，好修改的时候呢，可能会提示文件不可用，没有关系，直接点击试就可以了。

那如果呢你发现文件名的后面呢没有后缀的话呢，在云石的系统下，你可以点击文件夹的查看选项，然后呢去勾选这一个文件扩展名。

好，其他的操作系统呢，大家可以去搜索一下相关的材料。那修改完成以后呢，我们双击打开压缩文件，然后在压缩文件里面呢我们找到。

l 的这一个文件夹打开，它找到窝点xml 这一个文件，然后呢把它复制粘贴到桌面上这里。然后呢我们在系统中新建一个技师的好把这个文件呢通过记事本进行打开。

然后呢其实呢我们在这里呢就可以看到啊这些呢其实就是对应的一个工作表的一个名称。好，然后我们使用记事本中的编辑功能，使用其中的替换功能，把幺七点全部呢替换为二零幺八年这里点击全部替换。

然后呢我们现在就可以在啊记事本中看到提供后的效果了。然后呢这里保存并退出。好，接着呢我把桌面上已经修改完成的这样一个点a xml 的这个wb 文件呢重新拖回到啊压缩文件里面去替换里面的啊原来的文件。

好，然后呢关闭对话框，回到文件夹里面。然后呢把这一个i 压的文件呢重新把控罪名修改回来，变成表格的形式。

好，然后我们再次去打开这个excel 表格，然后呢你就可以看到工作表的名称呢全都修改为二零幺八年了，那这就是第三部分的内容，批量修改表格名称的操作方法。

第四部分，我们来学习如何批量修改文件的名称。看到现在的这个文件夹呢，包括了有流水表格，还有基督总结以及呢工作汇报等文件。

那现在呢我们要对整个文件夹里面的这些文件批量的修改名称。在原有的文件名称前面呢加上二零一八年针对这种批量修改文件名称的场景，我们可以使用excel 加上批处理的方法来解决。

首先呢我在这个文件夹下面呢创建一个小表格，然后把它命名为批量修改文件名称，双击打开表格。然后呢。打开公式选项卡，然后点击名称管理器，然后新建一个名称名称。这里呢我就把他那面修改名称，然后呢引用位置。

这里呢我就要输入一个公式等于files。然后呢是刚刚是吸盘的这个位置。修改文件名称是一个文件夹。然后呢下面是哪些文件呢？就是星号星号。

这里呢代表的是任意文件，然后呢发就就取他的一个文件名称。好，然后点击确定再点击关闭。然后在a 一单。人格。

这里呢我们输入公式等于in this，然后是修改名称，就是刚刚在名称管理器里面新建的那一个名称。然后呢最时光的aee 好，得到第一个名称呢就是一月流水，然后拉下来啊，这些没有引用到的呢，我把它删除掉。

现在呢我们就可以得到文件夹里面的各个文件的名称以及他的后缀名了。好，下一步呢，我们要把修改后的文件名称写出来。

我们呢是要在每个文件的。前面呢加上二零幺八年，那这里呢我可以在b 这里输入二零幺八年哦，这里还是韵味的中文的括号，然后呢把它复制下来。

然后呢新的名称呢，我们在西医这里写新的名称呢就是等于b e 连接ae 的号，然后呢得到各个文件对应的新的名称。

好，然后呢我们把熄灭了，复制一下，粘贴为值，然后把b 列给删除掉。接着呢啊我们呢在系列的输入这样的一个公式。

好去。湿疹于ren。然后呢连接服务，然后呢是一个空格好然后是k e 然后是连接服，然后也是一个空格。然后呢再连接。

第一好得到了这样的一个命令啊，然后复制填充公式，然后呢在文件夹中呢，我们新建一个记事本，好把它就命名为修改名称就可以了。

打开它，然后呢把杆杆系列的这个公式呢，不知道这个记事本下面。我们保存并关闭掉。然后呢我们也把这个表格呢给关闭掉。好，这时候呢我把这个修改名称这样的一个记事本的后缀名的修改一下。

修改为b a t 文件，然后提示不可用。这里没关系，我们直接点击确定好，然后我们双击这个批处理的文件。

好我们就可以看到呢，现在文件夹里面全部的文件，它的文件名称呢都在原来的基础上加上了二零幺八年这样的一个命令。

好，我们重新看一下好，对应的这个修改名称。的命令呢就是ren，然后是空格，然后是原有的名称，然后是一个空感，然后呢就是新修改的一个名称。

用这样的公司呢通过批处理的文件就可以实现批量操作修改名称这样的一个功能啦。好这个呢就是第四部分的内容，批量修改文件名称的操作方法。

第五部分，我们来学习如何在sr 中批量插入图片。看到现在的这个案例呢，是一份员工的花名册，其中呢包括有员工的编号、姓名、性别等信息。

最后呢还包括了有员工照片的信息。那当我们制作这样的员工信息登记表或者类似。格式的商品信息登记表的时候，如果员工或者商品很多的话呢，要一张一张照片的进行插入，然后呢还要调整它的位置，还有大小，这样的工作量会很大，而且非常耗费时间。

那有没有方法可以快速的完成这样的工作呢？在excl 中我们可以使用简单的公式实现图片的批量插入。首先呢我把员工的诈骗呢放在同一个文件夹里面。

那像现在的我们就把它放在一个员工照片的文件夹里。好，其中呢每一张照片呢都使用了员工的姓名来命名。好，那我们看回表格里面，现在呢在右边这里有这样的一条公式。这个公式呢就是用于把图片插入。

到excel 表格里面的。其中呢前面的这一段好，就是指的呢就是说啊把它对应的一个文件夹的位置啊，这里呢就是啊批量插入图片在c 盘下面。

然后呢员工照片上的一个位置，其实呢就是对应我们的这样的一个文件夹位置。后面这里呢其实他是b 二b 二的话呢指的呢就是啊对应的一个员工姓名。

因为我们的诈骗都是使用员工心灵来命名的嘛。所以呢这里呢直接引用的就是b 店的这样的一个新理念啊。最后呢是点g m g 这里呢其实呢就是文件的格式啊。我这里的图片呢都是采用p n g 格式的。

所以呢前面走。一个位置呢就是啊引用的照片的一个位置。好，然后呢再往后看呢，这个啊wide 还有嗨呢，就是对应的一个插入图片的宽度还有高度。这里呢都定义为一百。

好，那我们呢现在把这一个公式呢整个复制到这里来。好，然后呢啊复制填充公式得到啊一次得到呢这一个啊员工对应的一个照片的一个名称。

好，然后呢我们新建一个记事本，好把这一个呢依恋的这样的一个公式呢复制到记事本里面。好同时呢我们。把这个依恋给删除掉。然后呢我们重新把这个记事本的数据呢复制并且粘贴进来。

我们就可以看到呢，现在直接呢就把照片批量的插入到excel 表格里面呢。然后呢我们对这一个行列呢做一些简单的调整。

好那我们呢就可以实现这样的批量操作的功能了。好快速的把员工对应的照片插入吊销表格里面。好这。是第五部分的内容批量插入图片的操作方法。

最后一部分我们来学习如何批量新建文件夹。我们还是以刚刚的那个员工花名册的案例来举例子。像案例中呢，一共有八位员工。那我要针对这些员工，对每个人创建一个文件夹，用于存放他们的个人资料。

文件夹的名称呢。我使用员工姓名来说，命名方法非常的简单。首先呢我要把员工姓名提取出来。好，然后呢放在一个新建的工作表里面。

然后呢在b e 的这个单元格了，输入公式等于好md 然后呢是连接一个空格，然后呢再点。j a 一单元格好，然后呢复制粘贴公司，然后我在文件夹里面呢创建一个记事本，把它拉命名为批量新建文件夹，然后打开记事本，然后把b 列的这个数据呢粘贴到记事本里面，好保存并关闭。

然后呢修改记事本的会罪名，把t s t 呢修改为p a t p 处理好。然后这里点击是然后呢双击运行批处理文件，那我们就可以。

看到在文件夹中呢，就快速的生成了以员工姓名为命名的这些文件夹了。那以上呢这是第六部分的内容，批量新建文件夹的操作方法。

这一些呢就是本次课程的全部内容。这一课呢我们主要结合了asr 命令提示符和批处理三个方面的知识，实现批量操作的功能。

以上学习的几个例子呢，都是在我们日常工作过程中经常会碰上的场景。而学会了这样的批量操作的方法，能够大大的提高你的工作效率，再也不用耗费大量的时间来做机械重复的工作了。

这里要提醒大家的是，在使用命令提示符c md 的时候，文件讲了不能使用过多的中文来做命名。同时呢也。不能使用特殊符号来命名文件夹，而且呢文件夹最好不要在多个根目录下面，不然呢会导致命令提示是无法正常使用。

那这一节课呢就到这里，我们下一次课再见。
