# 第9课-初级数据处理

大家好，先我们来学习第九课初级数据处理在shell 里面，数据处理和数据分析占了我们工作中百分之八十的比重。

而在前面基础篇的课程里面，包括了查找替换数据分店和快速填充等功能，都能很好的帮助我们解决数据处理中所遇到的问题。

另外在第四课和第五课两节函数课程里面，其中的文本的函数逻辑函数以及查找引用函数里面提供的函数用法和实例。

但是一定要好好理解，掌握了这些函数和功能之后呢，基本就能解决百分之九十的问题了。那今天的课程我们具体来学习四个数据处理里面最常见的场景分别是表格转换，空行处理，数据对比。

数据查找本次课程的操作源文件。大家可以在微信公众号搜索维护后台回复零五零六进行获取。那现在我们进入第一部分表格转换的选型。表格转换中我们要学习的有两个部分的内容，第一行列转置。

第二因为表和二维表之间的转换，首先来看一下行列转置。看到这张表格在日常的工作里面，我们一般都是使用一行来存放一条完整的数据呃，列了存放一个数据项像。

这个表格里面一条数据呢比较包括了有日期，销售员销售技能三个信息。但有时候我们需要使用一列来存放一条数据，方便数据的查看。

这个时候呢我们可以使用行列转置的方法快速。实现选中这个表格，按键盘恳求加c 复制数据在空白的单元格。这里呢单击鼠标右键点击选择性粘贴，勾选右下角的这个转制点击确定。好，现在呢我们就可以看到表格中的行和列转换过来了。

现在呢是以一行存放一个信息项，然后呢一列存放一条数据。那除了可以使用选择性粘贴里面的转置功能以外，我们还可以使用trans sport 函数实现行列的转置。

大家可以在课后学习一下它的函数用法。我们先把这个表格删了。好，介绍完行列转置以后，我们再来学习一下一维表和二维表之间的转换。看到这张表格。

这是一个岸地区和月份计算销售金额的二维表。二维表呢更多的是作为统计报表用于数据的展示。那如果这个表格是一个登记表，无疑我就要把它转换为一维表了。这里介绍两种方法，第一种呢是通过数据透视表实现的。

第二种呢是s r 二零幺六版本才有的新增方法。使用数据选项卡里面的虫表格的功能实现。首先来介绍数据透视表的方法，依次按键盘的d to d 和p 调用数据透视表和透视图向导类型。这里呢我们选择多重合并计算数据区域，点击下一步默认选择创建单页阶段，点击下一步选定区。

这里呢我们选择这。表格点击添加好，点击下一步在现有的工作表里面进行创建。点击完餐就可以看到了，默认生成了一张数据透视表了。然后呢在最右下角这里双击这个数字系统呢，就会自动的创建一张新的工作表。

里面的表格呢，就把刚刚的二维表转换成一位表了。那如果在双击数据的时候呢，没有正常弹出工作表，而是提示无法更改数据透视表的这一部分。

你可以打开数据透视表的选项，在数据页签下面，把启用显示民事数据和复选框勾选上就可以了。那这是。一种方法。第二种方法呢是通过从表格的功能实现的是s r 二零幺六版本的新增功能。

选中这个表格，点击数据选项卡，点击从表格好确认是这个数据区域，然后点击确定生成了一个查询编辑器。选中第一列城市，点击转换菜单，找到力透系列遮功能，点击下拉菜单，使用栗透视其他类的功能。

好就可以把二维表转化为一维表了。然后呢选择文件，这里选择关闭并上载，这时候呢也会生成一张新的工作表，用于存放转换。

后的一位表。以上呢就是两种实现二维表转换为一维表的方法。接下来我们再来看看如何把一维表转换为二维表。这里也介绍两种方法。

我们先把这一个透视表删掉。好，第一种呢当需要转换的表格为数据的时候，像这张表格里面最后转换的是销售技能。

我们可以直接使用数据透视表的方式进行转换，选中表格并插入数据透视表。好把这个城市呢拖动到晗这里，月份呢拖动到列，然后销售技能拖动到值，就可以快速生成一张二维表了。

也就是我们的数据透视表。好，第二种呢，当然需要转换的表格里面的数据呢都为文本的时候就不能简单的使用透视表来实现呢。

因为指这个区域呢会采用技术这个计算类型，而非直接显示这个文本。看到这张表格，这里针对二零幺六的小版本呢，可以使用数据选项卡。

这里呢有个新建查询的功能，这里选择从文件选择从工作簿。然后呢选择当前工作簿，点击导入这里呢，选择表格转换这个工作表，然后点击编辑好，选中前面的这一些不相关的列。

然后。呢，进行一个删除列的操作。然后呢再通过这个删除行，把后面的这几个空行给删掉。好，这个时候呢，选中星期这一个练，然后点击转换选项卡，点击透视链。

然后只呢这个地方呢选择colen 幺六，也就是值班老师所在的这一个链，然后点击高级选项聚合值函数。这里呢选择不要聚合点击确定转换成功后呢，点击关闭并上载。

然后呢得到一个新的工作表，这个时候呢进行一些微小的调整就可以。得到一张新的二维表了。以上呢就是两种把一维表转换为二维表的操作方法。第二部分我们来学习数据处理中一个非常常见的场景，空喊处理其中包括添加空行和删除空行两个操作。

首先是添加空行。我们需要在每一条数据的下面添加空行做分割。但是呢空行的数目不定，有时候是一个两个，有时候是多个空行。大家在搜索这些技巧的时候，都会找到很多方法来解决。

但都是针对一种场景的。今天呢我们学习一种通用的方法来解决添加空行这个场景。虽然这个方法比较笨，但确实最好理解和操作的。比如说要在表。

俄中的每一条数据的下面添加一个空行。我们可以在表格的后面呢增加一个辅助列对数据呢生产序号。现在是需要添加一个空行复制序号在下面的连续区域这里进行沾边。然后呢对辅助列进行升序的排序。

好那我们就可以看到现在每个数据的下面都添加了一个空行了。那如果是添加两个或者多个空行的时候，只需要把序号按顺序复制粘贴n 次就可以了。

比如说这里呢。我要添加的是五个空行，我先撤回到上一步。好，这里呢就在后面在这个基础上面呢，再复制粘贴四次。好，然后呢再对这一个辅助列进行升序排序。

加上前面的一次呢，这里一共复制粘贴了五次。然后呢最后我们看到每一条数据下面呢都有五个空行了，然后把辅助列进行删除就可以了。

然后是删除空行对不规范数据的处理呢，除了重复值删除以外，就属空行删除了。打开这个工作表，看到了第一张表格。

这里如果我要对日期为空的数据进行删除，应该怎么操作呢？我们可以选中日期这一列按键盘，侃修家居，打开定位功能，定位条件。

这里呢选择空值，然后对着其中的一个控制单元格来单击鼠标右键点击删除，然后选择整行点击确定那日期为空的数据呢就被删除掉了。

好，看到下面的这一张表格。如果日期销售员销售金额都为空的时候呢，才是为空啊。这个时候呢，我们可以在表格的后面增加一个辅助列。好，然后呢使用看不了函数统计该行的空白单元格等于三的话呢，我们就对该行进行。

删除这里呢输入公式咖啡，然后是这个区域好，然后复制填充公式这里了筛选出等于三的好，然后呢进行一个删除，行好取消筛选。

然后呢我们看到现在呢当三个信息上都为空的数据呢就被删除了。接下来第三部分我们来学习数据对比。数据对比的场景有非常多，今天主要总结三个方面，包括两列对比项目对比和雅阁对比。第一部分呢我们先来学习两列对比。

两类对比的主要场景，包括两种。第一种同行。两列核对，看到这张表格，表格里面呢是分店的库存数量和实际盘点数量的对比。要快速找到两类的不同，可以怎么操作呢？一般来说我们会使用与函数来判断库存数量和盘点数量是否相等。

其实呢我们还可以从b 列开始选择选择这两类按键盘的control 加右斜杠这样了就可以以b 列的数据为基准，快速找出系列和b 列同行不相等的数据。

然后呢使用填充底色的方式呢，高亮显示。第二种呢是两类的对比，找出是否存在包含的关系。这种就是我们在实际工作过程中经常遇到的比对场景。看到这张表格，比如说我要找出。

系列中哪些数据在a 列是有的，我们呢可以使用v 了跨函数在这里呢输入公式等于v 音路com 茶场的是f 三这个单元格。

然后呢查找的区域是一三到一十五，这里呢使用绝对引用它查杀的是第一列，然后是精确匹配好，然后复制填充公式。

如果得到有值的话呢，证明a 列和b 列都存在这个数据。如果显示的是ma 这个错误值，郑鸣b 列中的这个数据在a 列中并没有找到，不存在于a 列。

同样的我们也可以使用他也函数来实现在这里呢输入公式等于他。然后呢在这个区域里面是否有长大f 三这个值好，然后复制填充公式。

由于a 列的数据呢也不存在重复的情况，所以如果必列的数据呢存在于a 类的话，就会统计为一。如果不存在呢，则会统计为零两个公式的方法呢是一样的。

得到的比对结果呢也是一样。大家呢在使用的过程中，看看哪个比较适合自己就可以了。除了使用函数来做统计以外，我们还可以使用数据选项卡中的高级筛选功能，提取两面相同的数据，点击数据选项卡，这里点击高级列表区域。

这里呢选择一三到一十五。然后呢。条件区这里呢选择f 三到f 十五。好，这里没选对好，然后呢将筛选结果呢放在i 三这个单元格，然后点击确定好就能够呢把两列都存在的数据快速提取出来了。

第二部分是项目对比，在两列对比的基础上，再进一步就是项目对比了项目对比一般可以分为两种情况，丹条件项目和多条件项目。

那接下来我们具体来学习一下到底如何实现项目对比。看到第一个表格，这里呢属于单条件项目的对比。很多时候我们都会遇到这样的情况，要计算系统中的库存数量和实际。g 盘点的数量是否相等。

但这两个数据呢又分别存放在不同的表格里面。这时候我们可以使用we do cup 函数查找数据后再进行对比。

在这个表格里面呢，查找的依据呢是分店名称。这里输入公式等于娱乐卡，然后依据是分店名称涨的是a b 两列里面的第二类库存数量。

然后是精确匹配好，然后复制粘贴公式，得到每个分店的库存数量。那接下来呢，其实就是两边对比的事情了。我把查找后的结果转换为值。好，然后呢可以使用啃秋霞有斜杠的方式呢，高亮显示两列的布。

行也可以呢通过两列的相减得到差值。然后呢看到下面这里第二个表格，这里呢属于多条件项目的对比。现在呢除了分店以外呢，还有商品名称这个条件。面对这样的情况，如果使用v 的跨盘数的话，要先把两个条件合并起来，再进行查找引用显然就比较麻烦了。

面对这种情况，我们可以使用另外一个函数商品非函数来实现这里呢库存数量进行查找的话呢，可以输入公式等于三b face。

然后计算的这。直呢是系列这一列。好，然后第一个条件是a 十四到十九，然后对应的师以十四这个单元刚好。第二个条件呢是b 十四大b 十九商品名称。

然后呢对应的条件呢就是这里这里应该是f 四四好得到的结果呢，广州东站a 商品的库存数量啊是十三八。好复制填充公式，得到每个分店每个商品的库存数量。

然后呢也是一样，把它转化为直然后。金星一个花书的比对，又或者还是以刚刚的方式进行相减的方式得到差值。这里呢商品费阐述的用法呢是根据多个条件的判断，然后实现对满足条件的数据进行相加，从而得到最终的结果。那除了实现多个条件的项目对比以外，其实呢上面写函数对实现两个表格的汇总对比也是非常方便的。

看到后面的这两个表格，如果我要对分店名称或者是商品名称进行汇总后，在实现数据比较的话，我们一般会想到使用数据透视表或者是合并计算的功能。

但三b p 是函数对处理这方面的问题会更快。而且呢这里是单个条件的汇总直接。使用三米反函数也是可以的。这你要得到的是广州东站的库存数量。

这里输入公式等于上好这里的范围呢是a 十四到a s 九，然后条件呢是k 十四。然后要计算的相加值，这里是七十四到七十九。

好，然后确定得到广州东站汇总后的库存数量。然后后面的这个单元格了，要得到的是实际盘点数量。这里呢输入公式等于杀灭，然后是一十四到。一十九，然后条件呢是分店名称。

然后呢这里的合计指示居十四到七十九。好，然后分别复制填充公式，就可以得出每个分店的库存数量和实际盘点数量了，可以直接进行比较同比呢也可以得出商品的库存数量和实际盘点数量的对比。

那如果大家在课后有兴趣的话呢，可以试试使用数据透视表来实现这样的两个表格的比对，看看哪一种方法比较便捷和实用。

至于sum f 和subspace 函数的用法，大家如果忘记了，可以在前面的函数课程里面。a 故选c 最后一部分我们要学习的是统计表格的对比。

看到这张表格属于一张二维表，统计的是各地区各月份的销售情况。那如果面对这样的两张二维表，要怎么实现数据的对比呢？应该有不少的同学会想到，可以使用刚刚学习的项目对比的方法使用we look up 或者是三mp 函数来做数据的查找。

然后再通过最原始的两列对比来实现。但这样做的话呢就很复杂了。面对这种二维表格的对比，最快捷的方法呢就是使用选择性粘贴做减法运算，可以快速比较出两个表之间的差异。看到两张表格的地区呢和月份都是。

是顺序都是一致的。也就是说数据呢是一一对应的，我们可以直接复制后面的一张表格的销售数据。然后呢在北京缔约的这个单元格使用选择性粘贴，然后选择运算为减点击确定经过两个单元格的相减。现在我们就马上可以看到哪些数据是有差异的了。

但很多同学呢就会有疑问了，一般在做表格核对的时候，表格里面的项目顺序都是不一样的。比如说第二个和第三个表格地区的顺序不一致，这时候应该怎么办呢？我们可以通过vlok 盘数做数据查找。

然后。后进行比对。但今天呢我要介绍一个比较简单的方法。还记得我们前面学习的自定义排序功能吗？当两个表格的地区顺序不一致的时候，我们把它变成已致，然后再通过相减的方法就可以实现了。

点击文件选项卡，点击选项。在高级叶谦这里呢找到编辑自定义列表。好点击这个在单元格中导入序列。这里选择第二张表格的这个顺序，点击导入，再点击确定。

好这里带点击确定。然后对第三章表格进行一个。排序这里呢选择地区，然后牲畜这里修改为自定义序列，然后选中刚刚生成的序列，点击确定，再次点击确定。现在我们看到第三个表格中地区的排序呢就跟第二个是已知的。

这时候呢我们在做一次选择性粘贴，把他相见好，得到两个表之间的差异数据就可以快速实现数据比较了。最后一部分我们来学习数据查找在前面的函数课程里面，我们学习过几个查找引用函数的用法。

包括有路com we look up h 罗卡盘数industry match 组合。在这基础上，我们具体看看这些查找引用函数在实际工作过程中的应用。

看到这张表格是一个员工花名册，我要通过员工的姓名查找出相关的信息，包括所属部门、职位合计工资等鑶场景了。

我们一般使用v r 卡盘函数在所属部门这里呢输入公式等于you look com 查找的是猪猪这一个员工。

然后在这个表格里面继续查找所在的列呢是第二列，然后精确匹配得到猪猪所在的部门呢，是运营部可以通过这样的方式呢把职位和合计工资都查出来，这是最基础的方法。

但这样的公式呢你。发现两个不方便的地方。第一个，如果当数据列有很多的时候呢，要去数所在列是第几年是非常麻烦的。第二个呢如果要查询的信息项一旦改变了，比如说我这里本来查找的是职位，现在修改为资本工资，那公式就要重新调整了。

我们可以通过怎样的调整在输入疑似公示以后，不但可以复制填充公式，还可以基本不修改公司的情况下任意修改所需查找的信息项呢在v 六块盘数的基础上，我们只需要加上match 函数的嵌套就可以了。

我把所属部门这个公司呢重新修改一下。好，等于relook 卡查查。的单元格呢还是a s。然后呢是在b 三到举起这个区域里面进行查找。

第三个参数，这里呢使用max 函数，然后local 的这个纸呢选择所属部门，然后是在b 二到g 二这一个标题涵里面去查找属于精确查杀。

然后最后补充遇到code 只有一个参数精确匹配好，得到是运营部，然后呢复制填充公式就可以得到其他对应的形象了啊，这里要把它修改为常规。

好在这个公式里面呢，我把第三个参数。所在列修改成用match 函数来做查找。以第一个公司为例子呢，这里的含义呢就是查找所属部门在这一个标题行里面是在第几列。好，这里呢math 函数计算出来的呢应该是第二列，对吧。

所以呢为了卡盘数，就是在整一个区域里面涨跌二链查找出结果就是与宁波啦。那一旦我需要查找的信息向改变了这里的职位呢，修改为基本工资。

好，我们看到查找出来的结果立马就会变成基本工资了。猪猪呢这里的基本工资。那是四千五百块钱使用。为了看加编曲的组合呢，查数据就比原来的基础用法要方便多了。

接下来我们再来看一下关于v 了卡盘树一对多要查找的案例。我们都知道we look up 函数在查找数据的时候，如果有多个结果是满足查找条件的，只会返回第一个结果。

那怎么通过规则化函数实现一对多的查找呢？看到后面的这一张表格，我要查找出一般有哪些学生，他们对应的学号和姓名等信息。

这种情况下要实现一对多查找。我们首先在表格的前面增加一个辅助列，在这里输入公式等于a 三，然后闭上也要参与函数。

这里的区。欲呢是k 三的一个动态区域，然后对应查找的是k 三好然后复制粘贴公式，得到一个用班级加上数字的数据。

这里使用了抗议法术做技术。当一般出现第一次的时候，后面就是一第二次呢则是二。同理了，二班也是一样，然后呢是查找学生的学号信息，在这里输入公式等于娱乐卡，查找的是p 二。然后并上world ae 作为第一个参数。

然后呢是在这一个区域里面进行查找。然后学号是在第二列，然后是精确匹配。复制填充公式得到第一个结果呢是一零一，然后往下填充以后公式里面的肉函数呢取的是行号。ae 呢行号是一跟p 二单元格连起来了，就是一般一以此类推，从而得到一八二一班三等得到学号。

这一列好，同比呢，我们可以通过这样的公式，在姓名里面进行一个取值。好也是p 二这个顶上your road a e 然后是在这个区域里面，然后姓名的话是第四列。

好得到姓名这一类的信息。看到后面。的结果。这里呢当查找不到数据的时候，就会提示m a 的错误值。我们可以使用if err 函数来屏蔽错误值，把它变成空文。本那只需要呢在这两个公司的前面增加一个if ever 好啊，它变成空文，本这里也是一样。

加一个if f l l 函数好，然后呢重新做一次填充就可以了。那如果呢我现在把这里的班级呢调成为二八，那相应的学生信息呢就会变成阿凡的学生呢，一个简单的信息查询系统去做出来了。

除了把数据信息提取出来以外，我们很多时候也可以使用条件格式高亮显示。是符合条件的数据相对而说做法就比较简单了。

比如说我要根据班级和性别这两个条件，高亮显示表格里面符合条件的数据。我们可以选中这一个表格，点击条件格式，点击新建规则，使用公式确定要设置格式的单元格这个类型。

然后在这里呢输入公式等于好。第一个条件呢就是k 三所在班级。这里这个大军哥好，这里呢使用的是列绝对引用等于这一个s 二。然后呢成语。

第二个条件。性别这里是m m 三，也是采用列的绝对引用等于八s 三这个单元格好把它格式呢设置为浅的粉红色，然后点击确定。

那我们可以看到一般属于男生的信息就会变红了。那当我们修改条件的时候呢，表格中标红的信息呢就会随条件的改变而改变。

把满足条件的数据呢高亮显示出来了。这里呢要注意的是设置条件格式的时候啊，两个条件都是使用了列的绝对引用行的相对引用。

因为呢对于整一涵数据信息来说呢所在。班级和性别两劣势不改变的。所以呢这里呢必须要用绝对引用来固定。接下来我们来学习今天的最后一个数据查找场景，看到最后面的这样的一个表格。

我们要根据地区航月份查找出对应的销售量。对于这种二维表格来说，最适用的就是index 加match 函数组合了。

在这里呢输入公式等于in dish，然后呢是在v 三到a 七这个区域里面进行查找。航的话呢使用match 传输好说你呢选择的是a 二在u 三到。

九七里面去查找好列呢，取得是在一个单元格在v 二到一二顺利进行查找。好，得出呢广州二月份的销量呢是一千四百一十是对的。

公司利用了买阐述分别求出地区所在的行月份所在的练。再通过index 函数呢求出所在行业的数据，从而得到最终的结果。

数据的查找呢可以使用index 加match，我们也可以通过条件格式的方式呢高亮显示出这种行列交叉查找的结果，选中数据表。

点击条件格式，点击新建规则使用这个公式确定要设置格式的单元格这种类型。然后呢在这里输入公式等于u 三。

好，这里呢使用的是列的绝对引用，就等于这一个ad 二号格式呢，我们选择为浅蓝色点击确定好标示出广州这一行的数据。

然后呢我们在新建一个条件格式好公司。这里呢书。步入等于你的。然后呢这一次是使用含的绝对引用，然后呢是等于a 第三号和十岁，你呢也选择为浅蓝色点击确定，就可以标示出二月这一列的数据了。

然后最后呢我要再交叉的这个地方要四幺零进行一个突出的显示。那我们其实呢就是把前面所见的这个规则好，这里呢我把它复制一下。

另外一个呢就是这个规则复制出来。好，然后呢当两个条。件都符合的时候，就是这个交叉的一个结果了。我把这一个公式复制出来。

好，然后呢这时候在新建一个条件格式的规则选择最后一个类型，然后把这个条件暂停下来，使用的是加粗的红色字体。

点击确定好就把这个香蕉的一个结果呢突出显示出来了。那我们可以随意的去改变这样的一个条件，就可以查出我们对应的结果了。

以上呢就是本次课程的全部内容。这一节课呢，我们主要学习的四个数据处理里面。最常见的场景包括有表格转换、空行处理，数据对比和数据查找。在这些内容里面呢，大家要把重点放在数据对比了，数据查找这两个方面的学习，力争呢减少月底加班加点做统计对账的次数和时间。

今天的课程就到这里，我们下一次课再见。
