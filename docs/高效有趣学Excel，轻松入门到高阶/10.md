# 第10课-高级数据处理

大家好，现在我们来学习第十课高级数据处理。在上一节课初级数据处理课程里面，我们学习了几个常用的场景，包括表格转换，空行处理数据对比和数据查找。

这些场景都是针对单个工作表的数据进行处理的。那除了要学会单个工作表的数据处理以外，我们每逢月末年末都要进行数据汇总、统计和分析等工作。

这时候我们就会接触到多个工作表的数据处理场景了。今天的课程我们来学习高级数据处理，其中包括组合工作表、合并工作表、拆分工作表、合并工作部和拆分工作部五个部分。

本次课程的操作源文件，大家可以在微信公众号。搜索维护后台回复零五零六进行获取。首先我们进入第一部分组合工作表的学习。当一个工作簿中有多个工作表需要实现相同操作时，我们可以使用组合工作表的功能。

在学习组合工作表之前，我们首先来回顾一下工作表的切换。我们可以按键盘的control 加path up 和page down 来实现相邻两个工作表的切换。

control 加pitch down 是往右切换恳求甲拍摄，而是往左切换，可以提高你切换工作表的效率。

但当工作簿里面有多个工作表，而且需要切换的两个工作表之间跨度很大。比如说我要从汇总这张。工作表直接切换到一日这张工作表中间。这里假设还有二十多张工作表。

这时候呢我们应该怎么快速定位，我们可以把鼠标移动到左下角，这里点击鼠标右键调用激活窗口。在活动文档中呢，选中一日，然后点击确定进行快速的切换。

这是关于切换工作表，我们必须学习的两个小技巧。那接下来我们具体来学习一下组合工作表操作的两个场景，分别是批量编辑和快速球哈。

看到这几张工作表，每张工作表的格式呢都是一样的。现在我要在工作表的开头增加一行标注相同的表头。我们可以呢分别对每张工作表进行相同的操作。在开头这里呢增加一行，然后呢实现合并单元格，然后输入表头，重复操作n 次呢，我们也可以实现两头的添加。

当然这样操作就非常浪费时间的。那我们还可以使用组合工作表的功能，实现批量的操作。选中第一张工作表，然后按着键盘的shift 键，然后点击五日的这张工作表。选中连续的工作表共五张。

那如果我要选定全部工作表呢，我们可以对着任意这样工作表，点击鼠标右键，然后使用选定全部工作表。这时候全部工作表都处于选中的状态。

在开头这里呢插入一行，然后合并单元格，填充底色增加。把这个边框线，然后输入标题，产品销售情况好，调整一下样式。

操作完成以后，我们对着任意一张工作表呢，点击鼠标右键使用，取消组合工作表。然后我们切换一下每张工作表，就会发现每张工作表的开头都添加了相同的表头。

这就是组合工作表的批量编辑功能。除了批量编辑以外，花工作表的求和也是大家在日常工作过程中的痛。我们要把一日至五日。每个分店每个产品的销售情况统计到汇总的这张工作表里面。

我们可以发现美。三，工作表的格式呢都是一样的，产品对应的销售情况。在每个工作表中都是在同一个单元格。但是很多人在做求和的时候呢，是通过一个一个单元格相加的方式实现的。

比如说广州东站产品一的汇总，在这里呢输入等号，然后呢依次的去选择每个工作表b 三的这个单元格中间呢用加号相连，实现求和得到求和的结果是两万四千零九十二。

但这样操作起来就很慢了。对于这。用格式规范的多工作表汇总，我们可以使用公式来完成我们在这个公式里面看到。其实呢就是对五个工作表中的b 三单元格进行求和。

这里把公式修改为上，然后呢是一个单引号，然后是一个信号单引号括起来，然后是一个探讨。第三好回厕所也能够得出求和结果。

为两万四千零九十二。再重新看到这个公式，现在呢修改成了上一日到五日，然后判号b 三。所以呢刚刚公式里面的信号代表的其实就是除了汇总的这张工作表以外，其他活动工作表也就是一日。十五日，这五张工作表。

从而实现快速的求和。那除了全部工作表求而以外，有时候也会有其他的求和需求。比如说要求出一至三日的汇总，或者是第二日和第四季的汇总。那公司应该怎么修改呢？如果要求出一日到三日的汇总，其实呢就是前面三张工作表的球花。

因为工作表示连续的，我们可以把公式呢修改为一日，然后这里的五日修改为三制好就可以得到结果为两万一千九百二十五。

那如果是要求出第二日和第四季的汇总犹豫呢工作表示不连续的。我们的公式呢应该修改为呃，是的b 三感觉。啊，中间用逗号隔开，然后这里是四日的冰山单元格。好，分别选中两个单元格进行求和，中间用逗号隔开，得到结果呢为七千三百九十四。

这就是三种花工作表求和公式的写法。这里大家要记住，如果是对全部工作表进行求和的话，可以使用星号来代替工作表，就无需一个一个的去选择了。

我现在呢重新把这个求和公式修改为一日到五日的。好，在起诉书第一个结果以后，可以通过公司的复制填充得到其他分店和产品的求和结果，从而实现快速汇总。

在学习完组合工作表以后，接下来我们要学习的是合并工作表。每逢月末我们在工作中经常会遇到的场景是什么？其实把独立的日流水表汇总成月报表，方便我们做数据的统计。

一般来说，我们都会喜欢在一个工作簿下面去建立多个工作表。而每个工作表则会存放一天的流水数据。但是到了月末的时候，我们就会发现要做出一个月的数据统计，实在太麻烦了。今天针对这个问题，教大家两种比较常用的处理方法，分别是花工作表的单元格引用和查询编辑器。

我们先学习第一种方法夸工作表的单元格引用这种方法适用于工作表数量不多，且每个表格的数据量也不多的。场景在这种情况下，我们可以用这种比较简单的方法来实现数据的汇总。

看到六月至十一月这几项工作表，每张表格里面呢大概也就是二十条数据左右，一共六张工作表。面对这么少的数据量，我们一般都会选择始终复制粘贴的方法。

除此以外呢，跨工作表的单元格引用做起来也是非常方便的。我们现在要汇总的是每个月的数据，包括呢日期，销售员销售金额三项信息。

后面呢再去补充这个序号，首先要把六月份的数据拿过来。好，打开汇总这张工作表。然后在日期这里呢输入一个等号。然后呢选择六月这张工作表的第一行的日期。

好做单元格的引用得到日期，然后呢往右填充公式，得到销售员和销售金额的数据。这里呢把它重新修改为常规啊，得到销售金额。

那么呢一行数据呢就引用好了，然后呢选中三个单元格往下填充公司。那我们可以看到六月份的数据呢都被引用过来了。

看到下面的这几条数据，这几个日期格式数值呢其实也是等于零。代表了从这一行开始，六月份的数据已经没有了。

上面的这一些呢才是六月份的数据。然后从这里开始引用七月份的数据。好，然后呢往右填充公示，然后也是一样往下填充公式，得到七月份的数据，然后依次呢把八月至十一月的数据呢一一引用过来就可以了。

做完所有的数据汇总以后，最后一步呢记得要把表格中的数据做一次选择性粘贴，把数据呢粘贴为值，就可以完成整个工作表的数据汇总了。

针对工作表。傻数据量少的场景，我们可以使用复制粘贴或者当然学习的跨工作表单元格引用的方法来实现数据汇总。

但如果工作比较很多，又或者是数据量很大的时候，刚刚介绍的两种方法呢，操作起来就非常麻烦了。这时候我们可以使用查询编辑器的方法来完成多工作表的数据汇总。

但我们知道这个功能呢是二零幺六版本新增的。那以前的版本应该怎么办呢？在这里提供一个微软官方的下载地址是用于excell'd 麦克索power quality ty 插件，适用于sf 二零幺零和二零幺三版本的安装以后呢，也可以直接使用查询编辑器的功能。

但这个地址呢有时候会提示四零四捞饭，多刷新几次呢都就不能刷新。出来了，这里呢会有一个安装的office 版本的要求。

使用二零幺零或者二零幺二三都可以进行安装。好，那查询编辑器呢具体应该怎么操作呢？在数据选项卡里面，好点击新建查询，然后选择纯文件从工作簿，然后选择当前文件点击导入在导航器这个页面下呢，勾选选择多项好。

然后呢把六至十一月的数据呢都勾选上好，然后点击右下角的这一个编辑。这时候呢会创建一个查询编辑器。在开始选项卡下使用合并功能区域中的追加查询，点击这个下拉三角形，然后呢选择追加查询。这里呢选择三个或更多的表。

好，默认选择的是六月份这张工作表。这时候呢把七月、八月、九月、十月和十一月呢的工作表依次选中，然后呢添加到右边要追加的表区域。

这里添加完成以后呢，点击确定好检查一下添加后的结果。好，这里呢我们找到有一些空行。好我们可以使用了删除行里。面的删除空行，把这些数据给删掉。

好，检查无误以后呢，点击文件选择关闭并上载。这时候呢后面呢会多产生了几张工作表啊，这一些呢给删掉好看到盱眙这里就从六月到十月的数据都汇总到这里来了。

然后呢序号这一列呢我们重新做一次排序。那我们可以看到数据就汇总完成了这个方法呢，用起来是不是就非常方便呢？好，最后呢还有一种比较原始的方法可以实现工作表的盒。

就是函数公司法使用函数做工作表的合并。难点呢在于两个，第一个是如何提取工作表的名称。第二个是单元格引用公式的写法，其中涉及的关键函数呢包括有给外部函数in the 是函数，还有indirect 函数以及名称管理器的应用。

使用起来了，被压复杂，在这里呢就不详细介绍了。有兴趣学习函数公司法的同学呢可以参考一下这里面的一个网址，是我之前整理总结的一篇公众号教程。

文章里面呢有详细的步骤和公式的写法。好在这里呢打开这个链接以后，拉到下面这里场景二这个场景二呢就是通过函数公式来实现。

工作表合并的方法在学习完如何合并工作表以后，我们来看一下反向操作拆分工作表。我们以刚刚做的汇总表格呢为例子进行讲解。

当我们收到的是一份完整的汇总数据。但这个时候我们需要和每位销售员核对销售金额。每个人要独立生成一张工作表。你第一时间呢想到的肯定就是通过筛选功能，然后筛选出其中一位销售员。

好，然后呢复制粘贴这些数据到一张新的工作表。当销售员人数不多的时候还好，但如果人数多了，耗费的时间就非常多了。

有什么好方法可以快速的。按某个字段拆分工作表呢，今天要学习的是数据透视表中的显示报表筛选页功能。我先把这个筛选给清除掉。好，然后呢选送这张数据表在现有的工作表中呢，创建一个数据透视表。

然后往各个区域呢拖动字段要求呢适合每位销售员核对销售金呢。这里呢我要把日期拖动到航这里，然后呢销售金额拖动到祉这里。

这里要注意的是，因为我是按销售员进行拆分，所以这里呢要把销售员这一个字段呢拖动。到筛选这个区域。然后呢我们就可以通过这里的一个下拉三角形呢去选择这一个销售员。这里呢也可以把日期的字段呢给展开好，可以快速的切换每一个销售员的一个销售业绩。

那怎么按销售员进行一个工作表的拆分呢？这里呢肖淑媛重新选为全部啊，把这个日期呢也折叠回来。这个时候选中数据透视表，然后再分析选项卡下点击选项，这个下拉三角形，然后呢使用显示报表筛选页。

好，这里呢只有一个销售员这个。筛选业字段，然后点击确定。我们看到呢现在以每位销售员的姓名呢单独生成了一张工作表。每张工作表里面存放的呢，就是这一位销售员的一个销售数据了。

可以通过这样的方法呢快速去拆分工作表。然后把工作表呢独立分发给每位销售员，完成这个数据的核对。刚刚学习的内容呢，都是在同一个工作簿下对工作表进行合并和拆分的操作。那如果面对多个工作簿又应该怎么操作呢？我们接下来先学习合并工作部，首先是使用v ba 代码实现合并应该有很大。

部分的同学呢还没有接触过v ba 方面的知识。我自己呢暂时也没有涉及这块的内容，所以特意去找了一段比较通用的v ba 代码，教大家如何实现使用宏来完成工作簿的合并。

首先我们看到这个文件夹里面有六至八月的销售数据。好，看到每个工作簿里面。其中呢六月份这里呢有两张工作表，而七月份和八月份呢分别只有一张工作表。那我们现在要把这些工作表呢都合并到第十课数据源杠三这个工作簿里面可以怎么操作呢？打开这一个需要做汇总的工作簿。

然后呢按键盘的auto 加f 十一打开v ba 窗口。找到左边的工程窗口，在这个工作簿的一个project 下面呢，双击shift 以这个工作表对象。

好，这时候呢打开文件夹里面的一个工作簿，合并代码这一个文本文件把整段代码呢复制粘贴到v ba 窗口下。

这是一段完整的代码命名呢为合并工作部，一般呢不需要进行修改。但有一个地方需要注意的，我们先看回文件夹，这里呢需要合并的工作部呢，六七八月三个工作簿呢都是以sls x 为后缀名的。

好，回到v ba 代码这里在。final open 开头的这段代码里面呢，fellow fitter，后面有两个sls x 上的一个啊后缀名。

那如果你要合并的工作部呢是x i s d 版本的格式的话呢，这里呢就要相应的去修改为sls。好，那现在呢我们合并的呢是高版本的excel。

所以呢我们这里重新修改过来，关闭鱼鳖窗口。然后呢在excel 里面呢找到这个开发工具选项卡。那我现在这个烧了并没有这个啊工具选项卡，所以呢可以对着其他的一个选项卡右键鼠标，然后选择自定义功能区。

在主选项卡这里呢重新勾选这个开发工具。然后点击确定就可以了。好点击开发工具这个选项卡。点击洪看到我们刚刚定义的宏合并工作部。

好，然后点击执行。然后呢去选择刚刚我们需要说做合并的三张工作部六，七八月，然后点击打开。我们看到很快的呢这三张工作部下面的工作表呢，就汇总到这一个工作簿里面呢。这就是使用v ba 方法实现的多个工作簿合并。

合并工作部以后，我们可以使用前面学习的合并工作表的知识，把他们汇总。一张工作表。但有的同学可能就会问了，有没有办法可以一次性的把多个工作簿的工作表合并到一个工作表里面呢，这样就不用分布操作了。

这里介绍一种方法是使用excel 里面的数据库技术实现的。也就是在数据选项卡下，然后自其他来源这里的一个my ichael south quality 加上sql 语句完成的。

这里呢因为会包含有sql 语句方面的知识。如果没有接触过的话，理解起来时间耗费会比较长，这里就不展开讲了。

有兴趣的同学呢可以在课后自己去找一下相关的资料和方法进行学习。除了上面介绍的v ba 代码方法以外，你手中还有一个。

非常好用的功能可以实现合并工作部。这个功能是比较和合并工作部具体要怎么实现呢？它的原理呢就是先创建一份表格模板，然后通过共享工作簿的方式分发给每个用户。

然后再通过比较和合并工作簿功能进行数据的汇总。合并看到这个工作部表格里面呢需要填写的信息呢，包括有日期销售员和销售金呢，以这个工作簿玮数据模板。

首先我们要把莱斯中的共享工作簿比较和合并工作部两个功能调用出来，放到审阅选项卡下面去。在这里呢按鼠标右键，然后选择自定义功能区。

在审阅选项卡下呢，我们新建一个组命名为。合并工作部。好，然后呢这里呢选择不在功能区的命令找到比较和合并工作部，还有共享工作簿两个功能。好添加完成以后呢，点击确定。

那相关的功能呢就会显示在这个省又选项卡下面的这个功能阻拦。第二步呢是要把工作部修改设置为共享工作簿，点击共享工作簿。

好，这个时候呢，如果弹出了无法共享此工作簿的提示，提示你要做以。家的操作，那应该怎么去处理呢？点击确定，打开文件选项卡，点击选项，点击信念中心，点击信任中心设置，然后找到最下面的隐私选项。

好，把保存时从文档属性中删除个人信息的复选框去掉，然后点击确定，再点击确定，然后重新设置为共享工作簿。

好，勾选使用旧的工作簿功能，而不是新的共同创作体验。点击确定好点击确定。现在呢我们会看到在这个工作簿的名称后面呢会有一个以分享这样的提示。好。

保存，然后关闭。然后把这一份工作簿保存为多份，修改文件名字。好，然后呢就可以把工作部分别发给相关的用户进行填写了。我们先打开这两张工作部。

这里要注意的是用户在填写的过程中，要尊重不改变不冲突的原则，进行数据的权限，不改变代表的是不能修改模板中的信息项。

比如说在这里增加一列或者删除一列这样的操作，就是按照现有的模板进行数据的填写。不冲突呢代表的是每个用户在填写的时候不能重复填写，否则最新的数据会把旧数据覆盖掉。

比如说院长是一张工作部呢，是要从序号一开始填写，他一直填写到需要时。然后呢另外一张教授的工作部呢，就得从十一开始填写了。

好，当用户呢把数据填写完成后呢，把工作部都收集回来，然后就可以开始合并汇总的工作了。那我们先做一些数据的填写。

好，把两个工作簿的数据给填写好，然后呢重新打开这一张木板的工作部，在审阅选项卡。这里呢点击比较和合并工作簿，然后去选择这两张需要做合并的胡萝卜。

点击确定好这里呢提示的是不能合并已打开的文件。我们啊这两张工作部呢先关闭掉。好，然后再做一次合并。我们看到模板中呢就添加了刚刚两个工作簿中分别填写的信息了。

当院长了和教授这两个工作簿中的信息被修改以后重新去使用这个比较和合并工作簿的功能就能够更新到最新的信息了。

当数据呢合并结束以后，我们就可以使用这个取消共享工作簿的功能。把当前的工作不共享取消掉，以免出现数据的修改和更新课程的。

最后我们学习如何拆分工作部。这里要介绍的也是使用v ba 代码的方法。但是跟刚刚合并工作部的方法有点区别。我们具体来看看如何。

实现工作部的拆分。现在看到这张工作簿里面呢，包含有三张工作表，分别是六月、七月、八月该把他们拆分为三个工作簿，分别发给不同的人去进行数据的核对。

按键盘的o to o 加f 十一或者是对着任意一个工作表点击鼠标右键选择查看代码，打开v ba 窗口。

在左上角project 窗口对着空白的位置呢，点击鼠标右键选择插入选择模块。然后呢我们这个地方呢把拆分工作部文件夹里面的这个文本文件里面的代码呢复制粘贴过来。

好，然后全选代码。使用运行功能下的运行紫过程用户窗体的功能。然后呢我们可以看到你收了就弹出了文件已经被分拆完毕的提示。好，点击确定，然后重新看回这个拆分工作簿的文件夹。

我们可以看到就按照了原来工作表的名称呢，把他们拆分为三个工作簿了。好，打开它，打开这些工作表以后，我们看到里面呢都只包含了一张工作表。

这这样的工作部呢，就可以单独的发给不同的人进行数据的核对了。再看魁v ba 窗口生理。如果呢我们要拆分的工作部要保存为低版本对象。里呢可以通过修改这个文件的后缀名，把sls x 修改为sls 就可以了。

好，以上呢就是本次课程的全部内容。这一节课我们学习的内容呢主要是针对多个工作表的批量操作，还有工作簿的合并与拆分。

每逢月底年末，这些技能呢可以帮助你快速的完成数据分发核对、数据汇总统计等工作。学会了这一节课的内容以后，就不用一直做复制粘贴了。

今天的课程就到这里，我们下一次课再见。
