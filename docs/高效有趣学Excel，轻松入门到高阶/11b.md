# 第11课-数据透视表应用（中）

答案需求完成数据透视表的建立以后，我们要做更进一步的数据分析工作，得到最后汇总展示。要用的统计报表的话必不可少，肯定就会涉及到筛选排序和组合在三个功能。

接下来我们以业绩流水表的表格为例子，具体来学习这三个功能的使用。首先我们先使用这个表格建立数据透视表，按业务员组别做筛选的项目。

然后统计每位业务员每种产品类别的投资金额合计。啊，这个相应的字段拖动到区域里面。好，第一个我们先来学习筛选功能，筛选功能可以分为报表筛选，标签筛选和值筛选三种类型。首先是报表筛选。

当字段呢放在这个筛选区域的话，该字段可以实现对全局的筛选。也就是现在的业务员主编可以通过点击下拉三角形选择业务员的主编实现筛选的效果。

默认呢是单选状态的。那可以点击这个选择多选的复选框。然后呢实现。多选的功能。同时呢他也是可以支持关键字模糊搜索后的筛选的。当然了报表筛选呢是支持多个条件的。比如说我现在要把销售城市放到筛选区域里面，这里呢就会包括有两个筛选条件的筛选条件呢，必须是同时满足数据透视表呢才会显示统计数据。

这是报表筛选功能，然后呢是标签筛选，它包括了航标签和列标签操作方法呢也是去点击晗标签或者是列标签的这个下拉三角形。

这里呢我们以航标签为例子，好，先把报表筛选的数据呢给清除掉。点击航标签的下拉三角形，选择标签筛选功能。

这里呢虾选条件就非常丰富了。那如果呢这个标签呢是日期类型的话呢，也会有相应的与日期有关的条件出现在筛选条件里面。

大家可以根据实际的情况，选择合适的筛选条件进行标签的筛选。这里有一个值得注意的问题。那如果标签是具有成绩，怎么按下面一个层级的标签进行筛选了。我现在把销售城市拖动到行区域，这里形成新的数据透视表。

我们看到现在标签。天筛选里面呢还是会按这一个姓名作为筛选条件的。如果我需要按销售城市进行筛选的话呢，我们可以对着阴蒂一个城市的单元格点击鼠标右键这里选择筛选前面有两个快捷方式，分别是仅保留所选项目和隐藏所选项目。

我这里呢可以实现快速对销售城市进行筛选的效果。我这里选择的是上海。然后呢我筛选里面选择仅保留所选项目报表中呢，就会把其他城市的数据剔除掉。只保留上海这个城市的数据了。

除了可以通过上面的快速筛选功能以外呢，在筛选你。面呢可以找到筛选标签这个选项在这里呢就是对销售城市这个下级标签进行筛选的条件呢也是比较齐全的。

列标签的筛选呢也是同样的操作，这是标签筛选的功能。最后呢是直筛选，只筛选功能呢依托于标签筛选功能，简单来说就是对标签的统计值进行筛选。

具体怎么操作呢？我先把这个筛选给清除掉好，然后呢把姓名这个字段折叠起来，形成一个以业务员和产品类别。统计投资金额的二维表。

如果现在要筛选出投资金额超过五百万的业务员，有几个具体数据是多少，我可以使用对姓名标签的值筛选功能，点击航标签的下拉三角形。

这里呢选择直筛选，选择大于这里输入五百万点击确定就可以筛选出总投资金额超过五百万的业务员呢，这是其中一个维度。

我先把筛选取消掉。同理，如果我要筛选出产品，那边投资金额超过一千万的有哪些，我可以对列标签作词的三。这里呢输入一千万，好点击确定筛选出有三个类别。投资金额呢是超过一千万的。

那对下级标签值筛选的方法也是一样。这里把他清除掉好，这里做一个展开好，这里呢对着销售城市这个标签呢进行一个选择筛选。

这里选择直筛选，就是对这个销售城市这个标签的投资金额合计进行筛选了。具体的操作方法呢就不再重复了，这是直筛选功能。

以上呢就是数据透视表中的三种筛选功能。再讲第二个排序功能之前，我们先来学习一下透视表中的一个小功能展开和折叠。

在航标签这里呢有两个字段形成了一个姓名销售城市二级的层级关系。我们可以看到在姓名的旁边呢，有一个减号点击它可以把清明下面的销售城市折叠起来。

只看这位销售员的投资金额，总计点击加号，可以重新把销售城市重新展开。可以把销售城市展开看回二级销售城市的细分数据。

当然除了可以通过加减号进行展开和折叠操作以外，我们也可以通过单击鼠标右键再展开。折叠这个选项里面呢选择相应的功能，实现批量的展开和折叠操作。

接下来是排序功能，先把这个销售城市呢移除。大外面啊形成一个以姓名和投资类别统计投资金额合计的简单二维统计表数据透视表呢默认是按标签进行排序的。

在这个案例里面呢，航标签为姓名文本型的数据。默认呢就是按姓名的首字母进行升序的排序列标签也是一样的排序方式。

那如果我现在要改变默认排序，可以什么操作呢？这里有两种方法，第一种是移动功能，属于手动排序的方法。比如说对于现在的产品那边。

我想调整它的排列顺序，依次呢为股票型、理财型、货币型、债券型混合型这种排序方式呢既不是按列标签对拼音首字母的排序，也不是对投资金额合计值的排序。

我们称之为自定义排序，可以通过移动的功能来解决。其实呢在这个案例里面呢，我就是要把混合型放到最后面，然后呢你才行，还有货币型的位置调换一下就可以了。

首先我选择混合型这个单元格，单击鼠标右键选择移动选项。好，这里选择将它移至末尾。然后呢这里呢选择理财行，然后。你是选择这个移动功能，选择将李才行上年。

好的，那他呢和货币型的顺序呢就调换过来了。手动型的数据排序呢，我们可以使用移动功能来解决。第二种呢是排序功能，属于自动排序的方法。现在的行标签呢姓名是按升序做排序的。

我们可以点击航标签的下拉三角形。这里呢选择降序，那姓名呢就会按降序进行排列。字母靠后的姓名会排在前面。那如果我需要按照投资金额的总计或者是某一个产品类别的投资金额进行排序的话，可以怎么操作呢？比如说我要按投资金额总计排降序，我可以选中。

总激烈中的任意一个单元格数据，点击鼠标右键选择排序功能。好选择降序。那整一个表格呢就会按投资金额的总计进行降序排列了。同理，如果我要对某一个产品类别进行投资金额的排序的话，可以选中该列单元格的任意一个数据进行排列就可以了。

自动型的数据排列呢我们可以使用这个排序功能来解决。接下来是组合功能，组合功能最好用的地方呢就是在于对日期的组合了。

我们把销售日期拖动到含着你，然后呢把姓名移除掉。看看现在的这张数据透视表系统默认的。帮我们把销售日期按月组合起来了。在行区这里呢，除了有销售日期以外，在他的上一级就会出现一个月的字段。

这是通过组合产生的字段，对于日期类型的数据进行统计分析的话，一般都会根据开始日期和结束日期的跨度来对日期进行组合。

比如说对一个月的数据呢进行统计分析，可以按七天或者十天作为一个周期形成组合。那像现在的这个案例里面，它的日期跨度了为一年。

所以呢饮月或者季度作为周期形成组合呢，对统计分析来说会比较合理。当然了这个呢可以根据实际的需求进行调整。

现在系统默认的。帮我创建了一个月的组合。那如果我现在需要按季度进行统计，文化应该怎么操作呢？我先把这个月移除掉，对着航标签的跟你一个日期呢，我单击鼠标的右键选择组合弹出了针对日期类型数据特定的组合对话框。

这里呢默认是按月和日进行组合的，我点击它反选，然后呢点击基督好点击确定。那我们现在看到这个数据透视表就是按季度进行组合的统计。

每个季度的投资金额情况。那如果我要取消组合的话呢，我只要选中它，然后点击取消组合就可以了。这是对日期的。组合接下来是对数字的组合。

我现在把这个投资金额呢拖动到晗这里，然后把销售日期移除掉。然后在直趋这里呢，我们添加一个产品的类别。现在的计算类型呢就属于技术已投资金额和产品类别两个维度呢来统计投资的笔数。我对唐标签呢投资金额进行组合，默认呢每五十万为一个跨度。

这里呢我只需要统计零到五十万，五十万到一百五十万三个区间就可以了。那我可以把骑士值呢调整为零。好中此值呢调整为一百五十万，步长调整为五十万。好，这里呢进行一个。

组合的设置起始值呢，这里是李，然后呢中指指这里是一百五十万，然后是按五十万作为部长点击确定。得到了一张新的按投资金额组合的数据透视表，达到了统计分析的效果。

这是对数字的组合。最后一个呢是对文本的组合，我把姓名拖动到含着你来把投资金额呢重新放回职这里，然后把产品类别在职这个区域移除掉。

现在呢我重新把投资金额的计算类型呢修改为求和好。然后呢按投资金额的总计进行一个加息的排序。我们把总计金额。大于七百万的，分为第一档大于五百万的分为第二大，剩下的分为第三档。

满足第一档条件的呢是前面三位啊业务员，然后呢选中第一位业务员。按照键盘的shift 键，然后选中第三位好，然后点击鼠标右键点击组合。

这里呢就创建了一个以数据主义命名的组合。这里要注意的是，如果在做组合的过程中，发现原有的排序发生了改变，你可以通过重新对这一个总计进行一个降序排序来修改他们的顺序。

然后呢用同样的方法去把后面两党的。数据呢组合起来，然后对他进行一个命名的修改。这里应该是第三档，然后呢这是第二个，我们把这一个重新调整回来。这里应该是按姓名啊进行排序。

这个重新把第一大移动到开头。好，如果呢你不希望在组合的过程中啊产生这个排序的变化呢，你可以点击这里，其他排序选项里面有一个其他选项。

把每次。更新报表时自动排序这个复选框取消掉，那就不会出现每次组合的时候都会改变原有排序的情况了。以上呢就是第四节筛选排序和组合的全部内容。内容呢虽然有点多，但大家一定要好好掌握。

这对你在以后使用数据透视表非常有帮助。接下来我们学习数据透视表的数据刷新和炒作对应的功能呢。在分析选项卡的数据和操作两个区域功能组。我们首先来看看数据的刷新和更改数据源。

当明细表中的数据发生了改变。比如说我把第一条数据投资金额呢修改为一百五十万。你会。发现在数据透视表中呢，统计不会发生任何的改变。

这时候我们可以使用刷新功能来更改数据透视表中的统计数据刷新的功能呢有三种操作方法。第一种可以点击分析选项卡，下面这里的刷新功能。

好，我们第一条数据的对应的是慈爱，选债券型的对应的应该是这一个单元格。好，点击刷新。我们发现数据呢就刷新成两百万呢。这里呢还有一个全部刷新的功能，那他跟刷新有什么区别呢？如果当这个明细表作为数据源，建立了多个数据透视表的话，当明细表的数据发生了改变。

你要跟。鑫所有的数据透视表统计数据就可以使用这一个全部刷新的功能了。好第二种刷新的方法，我把第二条数据这里呢修改为一百四十万，对应的是田径债券型的数据。好，这时呢你可以选中数据透视表以后，点击鼠标的右键。

这里呢选择刷新，你会发现透视表也能实现最新数据的更新。第三种方法呢可以实现。每次打开表格的时候实现数据的更新，具体怎么操作呢？再分析选项卡，这里点击选项按钮，选择这一个数据的页签。

然后勾选第三个复选框，打开文件时刷新数据。好，点击确定。那以后每次打开文件时呢，表格中的数据透视表都会实现最新数据的更新啊。对原有明细表区域的数据进行修改的。

我们可以通过刷新功能来更新统计数据。那如果我要在原有的区域以外去添加新的数据，我们会发现刷新数据呢是不起作用的。

这个时候我们可以使用更改数据源的功能来改变数据透视表的数据区域。具体怎么操作呢？我们简单的介绍个例子，现在呢我要在第五十二行这里呢添加一条数据，数据呢是跟五十一行一模一。

一样的，我们可以用向下填充的方式进行添加。选中单元格区域以后呢，按键盘的恳求加d 快速添加。然后呢我们重新对数据透视表进行刷新。好，现在呢发现数据透视表没有给他变化。

我们在分析选项卡，这里呢找到更新数据源的按钮，点击他发现呢这样的一个区域呢，现在是以到ae 到h 五十二的，就是呢新添加的这个区域呢啊不在里面。

我们可以重新选择这个统计区域，把它包括在里面啊，点击确定以后呢。在这个统计数据呢就会马上发生改变了。但如果我们忘了更改数据源的话，那数据透视表呢就不能正常更新数据了。有什么方法可以解决这个问题呢？我们可以使用超级表的功能。

我们把这个区域呢选中以后，按键盘的恳求j l 或者是肯州加t 对明细表创建超级表。创建超级标以后呢，如果我在原有的基础上再次添加一条数据。

好，我们看一下现在呢应该是所谓股票型的这样的一个数据。作为股票型，先是一百七十万。好，我在最后呢以同样的方式添加一条数据。我们再回到这个地方来。

然后呢对数据透视表进行刷新，我们就会发现无需重新更改数据源，也能够正常的实现数据统计了。在这里呢，超级表的功能就是可以在添加数据以后自动的扩展统计区域，使数据透视表能够正常的实现统计工作。

然后我们看到分析选项卡下的这个操作功能区，这里呢有几个功能，我们简单来学习一下。第一个是清除按钮，包括了全部清除哈，清除筛选两个功能。

如果你要快速的把数据透视表中的各个区域的字段清除掉，可以直接选择全部清除。好，这里我们做一次回退。那清除筛选顾名思义的，如果透视表中有使用筛选功能的话，使用清除筛选啊筛选条件清除掉。然后呢是旁边的这个选择功能，大家呢可以根据里面的功能呢快速的去选定内容。

首先呢我们可以选定整个苏州市表以后，我们可以根据实际情况选择标签和值或者失职，还是标签达到快速选定的效果。

另外呢我们可以通过这一个移动数据透视表的功能呢，把数据透视表移动到新的单元格区域。比如说我要把它移动到这里来。

当然了你也可以选中整个。数据表以后呢进行剪切啊，重新把它剪切回来。最后我们学习一个让很多人都很头痛的问题。如何删除数据透视表？很多人想删除数据透视表，但经常呢会提示无法更改透视表中的一部分。

其实很简单，你只需要呢选择一个比透视表大的区域。比如说我要删除现在的这个数据透视表。我可以从业务员主编这里开始选择，然后呢一直到这个右下角的总机这里。然后呢按键盘的砥砺间，就可以删除当前的数据透视表了。

以上呢就是数据刷新数据透视表操作的一些功能。下一次。二呢，我们会讲到切片器日程表和透视图以及多表合并透视。这次课就到这里，我们下一次课再见。
