# 第11课-数据透视表应用（上）

大家好，下午我们来学习第十一课数据透视表应用。数据透视表是excel 中最为强大的功能之一。特别是月底季末年中的这些时间，需要做大量的数据统计。这是数据透视表，就能帮助你快速完成各种各样多个不同维度的统计工作。

它的原理呢就是把一个明细表进行分类汇总，而且可以随意改变慧一种模式的一种工具。今天的课程我们学习数据透视表的内容呢，包括以下七个部分，分别是插入数据透视表报表布局样式和选项值字段设置和计算字段筛选排序和组合数据刷新和数据透视表操作切片器，日常器和透视图多。

表合并透视本次课程的操作源文件。大家可以在微信公众号搜索维库后台回复零五零六进行跨区。首先我们进入第一部分插入数据透视表的学习。在前面的课程里面，我们简单介绍过数据透视表的原理和使用。

其中呢关于数据原表，也就是民事表的数据规范，包括航标题的缺失和名称相同，数据存在不规范日期、文本型数字和合并单元格等。

他们对数据透视表有什么具体的影响？大家可以回顾第六课。第二点，数据透视表用文中的内容在这里呢就不再重新复述了。

我们下面来学习如何插入一个数据透视表。看到这里的是一个员工一览表，这是一个明细表。天呢我们选中这张表格，点击插入在表格这个区域里面呢，找到推荐的数据透视表按钮。点击它系统呢会按明细表中的字段属性呢给出一些推荐的统计维度。

那如果这里有适合使用的选择以后呢，点击确定就可以了。但我们一般不使用这个功能，先把这个窗口关掉，点击旁边的数据透视表按钮。

这里要分析的数据区域呢，就是刚刚我们选择的这个表格，然后放置数据透视表的位置。这里要看具体的情况。如果呢你不希望影响现有的明细表，这里呢可以选择新工作表系统呢就会新创建一个工作表来存放生成的数据透视表。

这里呢我选择现有。工作表位置。这里呢选择l 三把数据透视表放在l 三这个单元格点击确定。我们看到从l 三开始的这个区域呢，生成了一个数据透视表的出行。

右边这里呢淡出了字段列表的版面，用于拖动相应的字段到不同的区域，实现不同纬度的统计效果。面板的上半部分是可用于统计的字段来源呢就是明细表中的标题以对应面板的下半部分是用于数据统计的四个区域，分别是筛选列行和值字段放在筛选区域。

可以通过该字段对数据透视表中要显示的内容进行筛选。字段放在裂区域。该字段呢会左右。排练显示放在行区域字段会上下排列显示。

最后一个是直的区域，当字段放在子区域，会根据这个字段进行求和技术等统计工作。我们用一个简单的案例来演示一下数据透视表的功能。

比如说我要按中心做筛选统计，不同部门，不同学历的工资收入。还记得前面提到如何去分解一个统计需求，然后把字段拖动到相应的区域吗？在这个案例里面，要可以实现按中心筛选，就把中心这个字段呢拖动到筛选区域。

然后统计的纬度是部门和学历，分别呢把它们放到行和列两个区域。统计的是工资收入，把工资收入了拖动到使这个区域。

那我们看到数据透视表呢，就完成了这样的一个数据统计了。这里要简单介绍一下行和列两个区域。根据用户的观感呢，我们一般会把数据较多的字段放在行这里，把数据较小的字段呢放在暗恋，方便用户查看这里。

部门呢相对来说要比学历多几个数据。所以我们就按这样的方式放置字段的。当然两个字段呢反过来存放呢也是可行的，也能做出统计的效果。我们看到最下面这里有一个延迟布局更新的功能是一个复选框。

相信很多人都用过数据透视表。但对这个功能呢也是不太熟悉的。他有什么作用呢？首先我把行列两个字段重新换过来。可以看到，当我们调整其中某一个字段的时候，数据透视表的展现呢就会根据适当的调整而改变。

我把部门拖动的行，这里马上就改变了样式。但当我们把延迟布局更新的复选框打上钩以后，我们重新呢把学历拖动到猎这里来。

数据透视表了，这时候就没有发生变化了。我们点击右下角的更新数据透视表，就会按新的布局显示。所以呢勾选延迟布局更新遮功能呢，他的用法就是可以让你在调整数据透视表的时候，把全部字段都放置完成后再做布局的更新。

建立数据透视表以后，你会发现他都是使用默认的样式进行展示的。那我们可以选中设计选项卡，通过这里面的布局选项和样式等功能对他进行优化。

接下来我们具体学习一下相应的功能。我先把数据透视表中的中心这个字段呢调整到这一个行的区域。好，放在部门的上面，让两个字段呢形成原有的层级关系。首先是布局中的分类汇总功能。

这里面呢有三个选项，默认呢是不显示分类汇总。我们可以在主的底部或者是组的顶部，这里呢显示分类汇总的数据，在这里呢就可以。

看到每个中心数据统计的结果了。第二个呢是总计功能在建立数据透视表以后呢，系统会默认的对行列做总计的操作。

看到这里了，底部还有最右边都有总计的计算，可以通过总机的功能来调整。包括对行列禁用总计或者是呢仅对韩启用，或者是仅对列启用。

好。第三个呢是报表布局，用于对数据透视表展现形式的调整。第一种呢是压缩形式展示，也就是现在的这种默认形式。第二种呢是大纲形式。

在这个透视表中主要的变化呢就是中心和部门两个层级呢分别存放在l 和m 两。个列。第三种呢是表格形式。这种形式呢就像我们一般使用的明细表那样，一条数据呢放在一行进行显示报表布局的下面呢，还有一组功能是用于项目标签展示的。

默认呢是不重复项目标签。那如果把它调整为重复的话，我们看到原来的中心呢只显示第一个值。那现在呢每个部门的前面呢都会有显示对应的中心呢，这就是项目标签显示的调整。最后一个是空行功能。

为了数据展示的美观呢，如果数据很多很密集的时候，可以通过插入空行在每个项目的后面呢插入一个空行进行分隔。

让项目与项目之间。有了区分，这是布局里面的几个常用功能。另外呢还有样式以及选项，就是对数据透视表来展现形式做总体的调整。大家呢可以在里面呢选择合适的一些啊样式方案，并相应的调整显示字体，力求了让统计报表看起来更加商务大方和直观。

数据透视表中的选项功能，除了可以修饰这一个展现形式以外，还有很多其他设置功能。打开数据透视表的选项功能呢，可以对着数据透视表中的任意一个单元格。

单击鼠标右键选择数据透视表选项，又或者呢是选中数据透视表以后点击分析选项卡。这里呢有一个选项功能，打开选项功能对话框，我们具体来看一下几个比较关键的设置在布局和格式页签下的格式一览。

这里对于空单元格的显示设置在数据透视表中，我们可以看到现在统计为空的单元格呢都显示为空。这里呢可以把它设置为零。

那报表呢看起来了就比较顺眼了。好，虽然每一个空值单元格呢都显示为零了。另外呢在每次更新数据透视表字段的时候，我们会发现烈宽都会随之改变。那如果你已经啊设置好适当的显示列宽，可以在这里的更新时自动调整列宽，把这个复选框给去掉。

那在更新。字段的时候呢就不会再调整，对应的列宽了然后呢可以看到显示的这个页签有一些学员在看到现在的这个数据透视表样式的时候，应该不太习惯。

因为在旧版本的excel 里面呢，字段的拖动形式不太一样。没关系，我们可以通过购物选择一个经典数据透视表布局的复选框，使用旧版本的骁的布局，方便你的使用。

在选项功能里面这三个功能了会用的比较多。其他的功能大家可以在用到的时候再去熟悉练习，像打印页签里面的一些功能设置呢。

如果后面发现跟数据透视表有关，但又不知道去哪里设置的话，往往就能在这里找到你的答案。学习弯路。去建立数据透视表，调整展现形式和一些基本的选项设置以后，接下来我们来看看值字段设置和计算字段的应用。当字段呢拖动到值这个区域进行统计的时候，字段属于数值类型。

默认的计算类型呢是求哈知道属于文本类型。默认的计算类型呢是技术。这里要注意一点的是，像现在一样，如果你把工资收入拖动到值这个区域计算类型呢默认为求和项。但如果你发现比如说成本部高中学历应该是有数据的，而不应该为零。

那就证明呢对应的明细表中的数据里面，该单元格的格式呢应该是文本而不是数值格式。是这时候呢需要把这些单元格格式重新修改为数值就可以了。

除了这两种默认的计算类型以外，系统中呢还可以统计平均值、最大值、最小值等。我们可以通过点击这个字段，选择字段设置在职汇总方式液氢下面呢看到计算类型在这里呢可以选择不同的类型达到统计的效果。

比如说呢现在我选择平均值，好，点击确定透视表中的统计呢，就会修改为各部门各学历的工资收入的平均值了。好，重新打开字段设置。

这里呢把计算类型重新调整为求和再打开旁边的这个显示。方式的夜间摸一样的显示方式呢是无计算。但有时候为了达到统计分析的效果，我们要对统计后的结果做占比的分析。最简单的呢就是这个总计的百分比。

好选择以后呢点击确定，然后重新把这一个总计调用出来。好，把工行给删除了。然后布局这里呢不重复项目标签。这里我们可以看到现在呢就不是单纯的求出部门学历的工资收入求和值了，而是把它转化为在总计的比例。

我们可以把部门给折叠起来。在最优。天呢可以很直观的看出每个中心的工资占比在底部呢可以看出每个学历的工资占比了。从而可以分析出公司的具体情况和工资分配的合理性，达到统计分析的结果。

当然了，大家在使用的过程中，可以根据实际的需求来调整值的显示方式。这里呢再介绍一个比较常用的显示方式，就是升降序的排列。

我们先对数据透视表的字段做个简单的调整。这里呢列我把他移除掉，含这里呢我只保留部门好，然后呢再拖动一个工资收入，到时这里来。

好，第一个工资收入呢的显示方式，我们把它调整为五计算。第二个显示方式呢，我们调整为降序排序。我们就可以通过这样的方式实现对工资收入进行部门的排序。这个功能呢也是在数据透视表中经常用到的。

大家记住就是通过这样的方式去实现的。除了对明细表中的现有字段进行统计分析，以外销还可以自定义字段做统计。

这个功能呢是计算字段点击分析选项卡。在计算这个区域里面呢，找到字段项目合集。好点击它点击计算字段弹出插入计算字段的对话框。比如说我要计算基本工资。

咱们的工资收入的比例。然后对这个字段进行统计。在名称这里呢，我可以把它命名为工资占比。在公司这里的，首先我选择基本工资。

好，然后输入符号左斜杠，然后选择工资收入，点击确定，再次到列表中呢，新增了一个名叫工资占比的字段，并已经添加到子区域。

这里做了工资占比的分析。不过切记计算字段里面只能使用简单的四则运算和少量基本的函数。如果是相对复杂的数据计算，建议大家还是先使用函数公式把值。放出来放到明细表里面，让这个数据作为明细表中的一部分。

在建立数据透视表说统计分析。好，那数据透视表的应用的上半部分呢课程就到这里，我们下一次课再见。
